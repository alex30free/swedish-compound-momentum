<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Research & Evidence — Compound Momentum</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600&family=Syne:wght@700;800&display=swap" rel="stylesheet"/>
<style>
  :root {
    --bg:      #080c10;
    --surface: #0d1318;
    --border:  #1c2830;
    --border2: #253340;
    --text:    #c8d8e8;
    --muted:   #4a6070;
    --muted2:  #6a8090;
    --white:   #f0f4f8;
    --green:   #00e5a0;
    --orange:  #ff6b35;
    --gold:    #f0c040;
    --red:     #ff4455;
    --blue:    #4d9fff;
    --accent:  #ff6b35;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 300;
    min-height: 100vh;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed; inset: 0;
    background: repeating-linear-gradient(
      0deg, transparent, transparent 2px,
      rgba(0,0,0,0.055) 2px, rgba(0,0,0,0.055) 4px
    );
    pointer-events: none; z-index: 9999;
  }

  body::after {
    content: '';
    position: fixed; inset: 0;
    background-image:
      linear-gradient(rgba(0,229,160,0.012) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,229,160,0.012) 1px, transparent 1px);
    background-size: 48px 48px;
    pointer-events: none; z-index: 0;
  }

  .wrap {
    position: relative; z-index: 1;
    max-width: 940px; margin: 0 auto;
    padding: 0 28px 100px;
  }

  /* ── HERO ── */
  .hero {
    padding: 56px 0 44px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 52px;
    animation: fadeDown 0.6s ease both;
  }

  .eyebrow {
    font-size: 10px; font-weight: 500;
    letter-spacing: 0.28em; color: var(--accent);
    text-transform: uppercase;
    background: rgba(255,107,53,0.07);
    border: 1px solid rgba(255,107,53,0.2);
    padding: 4px 12px; display: inline-block;
    margin-bottom: 18px;
  }

  h1 {
    font-family: 'Syne', sans-serif;
    font-size: clamp(24px, 4.5vw, 40px);
    font-weight: 800; color: var(--white);
    line-height: 1.05; letter-spacing: -0.03em;
    margin-bottom: 14px;
  }

  h1 em { font-style: normal; color: var(--gold); }

  .hero-sub {
    font-size: 13px; color: var(--muted2);
    line-height: 1.7; max-width: 620px;
  }

  /* ── VERDICT BOX ── */
  .verdict {
    background: var(--surface);
    border: 1px solid var(--border2);
    border-left: 3px solid var(--gold);
    padding: 24px 28px;
    margin-bottom: 52px;
    animation: fadeDown 0.6s 0.06s ease both;
  }

  .verdict-label {
    font-size: 10px; letter-spacing: 0.22em;
    color: var(--gold); text-transform: uppercase;
    margin-bottom: 10px;
  }

  .verdict p {
    font-size: 13px; color: var(--text); line-height: 1.75;
  }

  .verdict strong { color: var(--white); font-weight: 500; }
  .verdict .good  { color: var(--green); }
  .verdict .bad   { color: var(--red); }
  .verdict .warn  { color: var(--gold); }

  /* ── SECTION TITLE ── */
  .section-head {
    display: flex; align-items: center; gap: 16px;
    margin-bottom: 24px;
  }

  .section-num {
    font-family: 'Syne', sans-serif;
    font-size: 11px; font-weight: 800;
    color: var(--gold); letter-spacing: 0.1em;
    background: rgba(240,192,64,0.08);
    border: 1px solid rgba(240,192,64,0.2);
    padding: 4px 10px;
  }

  .section-title {
    font-size: 13px; font-weight: 500;
    color: var(--white); letter-spacing: 0.06em;
    text-transform: uppercase;
  }

  .section-cite {
    font-size: 10px; color: var(--muted);
    letter-spacing: 0.08em; margin-top: 2px;
  }

  /* ── CHART CARD ── */
  .chart-card {
    background: var(--surface);
    border: 1px solid var(--border2);
    padding: 32px 36px;
    margin-bottom: 32px;
    animation: fadeUp 0.6s ease both;
  }

  .chart-card p.caption {
    font-size: 11px; color: var(--muted);
    line-height: 1.7; margin-top: 20px;
    border-top: 1px solid var(--border);
    padding-top: 14px;
  }

  .chart-card p.caption strong { color: var(--muted2); font-weight: 400; }

  /* ── BAR CHART ── */
  .bar-chart {
    display: flex; flex-direction: column; gap: 10px;
    margin-top: 16px;
  }

  .bar-row {
    display: grid;
    grid-template-columns: 130px 1fr 64px;
    align-items: center;
    gap: 12px;
  }

  .bar-label {
    font-size: 11px; color: var(--muted2);
    text-align: right; white-space: nowrap;
  }

  .bar-track {
    height: 24px;
    background: rgba(255,255,255,0.03);
    border: 1px solid var(--border);
    border-radius: 2px;
    overflow: hidden;
    position: relative;
  }

  .bar-fill {
    height: 100%;
    border-radius: 1px;
    transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
    width: 0%;
  }

  .bar-fill.green  { background: linear-gradient(90deg, rgba(0,229,160,0.5), var(--green)); }
  .bar-fill.gold   { background: linear-gradient(90deg, rgba(240,192,64,0.5), var(--gold)); }
  .bar-fill.orange { background: linear-gradient(90deg, rgba(255,107,53,0.5), var(--orange)); }
  .bar-fill.blue   { background: linear-gradient(90deg, rgba(77,159,255,0.5), var(--blue)); }
  .bar-fill.red    { background: linear-gradient(90deg, rgba(255,68,85,0.4), var(--red)); }
  .bar-fill.muted  { background: linear-gradient(90deg, rgba(74,96,112,0.4), var(--muted2)); }

  .bar-fill.animated { width: var(--target-width); }

  .bar-val {
    font-size: 12px; font-weight: 500;
    white-space: nowrap;
  }

  /* Bar group divider */
  .bar-divider {
    height: 1px;
    background: var(--border);
    margin: 6px 0;
    grid-column: 1 / -1;
  }

  /* ── TIMELINE CHART ── */
  .timeline-wrap {
    margin-top: 16px;
    position: relative;
  }

  .timeline-svg {
    width: 100%; overflow: visible;
  }

  /* ── SCATTER GRID ── */
  .grid-chart {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin-top: 16px;
  }

  @media (max-width: 600px) { .grid-chart { grid-template-columns: 1fr 1fr; } }

  .grid-cell {
    background: rgba(255,255,255,0.02);
    border: 1px solid var(--border);
    padding: 16px 14px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .grid-cell::before {
    content: '';
    position: absolute; top: 0; left: 0; right: 0;
    height: 2px;
  }

  .cell-green::before  { background: var(--green); }
  .cell-gold::before   { background: var(--gold); }
  .cell-orange::before { background: var(--orange); }
  .cell-red::before    { background: var(--red); }

  .grid-window {
    font-size: 10px; color: var(--muted);
    letter-spacing: 0.15em; text-transform: uppercase;
    margin-bottom: 8px;
  }

  .grid-return {
    font-family: 'Syne', sans-serif;
    font-size: 22px; font-weight: 800;
    line-height: 1; margin-bottom: 4px;
  }

  .grid-sub {
    font-size: 10px; color: var(--muted);
    margin-bottom: 8px;
  }

  .grid-badge {
    display: inline-block;
    font-size: 9px; letter-spacing: 0.15em;
    text-transform: uppercase; padding: 3px 8px;
    border: 1px solid; border-radius: 1px;
  }

  /* ── REVERSAL DIAGRAM ── */
  .reversal-chart {
    position: relative;
    height: 200px;
    margin-top: 20px;
  }

  /* ── STUDY CARDS ── */
  .studies-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 52px;
    animation: fadeUp 0.6s 0.15s ease both;
  }

  @media (max-width: 600px) { .studies-grid { grid-template-columns: 1fr; } }

  .study-card {
    background: var(--surface);
    border: 1px solid var(--border2);
    padding: 22px 24px;
  }

  .study-card .study-tag {
    font-size: 9px; letter-spacing: 0.2em;
    text-transform: uppercase; color: var(--gold);
    background: rgba(240,192,64,0.07);
    border: 1px solid rgba(240,192,64,0.18);
    padding: 3px 9px; display: inline-block;
    margin-bottom: 12px;
  }

  .study-card h3 {
    font-size: 12px; font-weight: 500;
    color: var(--white); margin-bottom: 8px;
    line-height: 1.4;
  }

  .study-card p {
    font-size: 11px; color: var(--muted);
    line-height: 1.75;
  }

  .study-card p strong { color: var(--text); font-weight: 400; }

  .study-card .finding {
    margin-top: 12px; padding: 10px 14px;
    background: rgba(0,229,160,0.04);
    border-left: 2px solid var(--green);
    font-size: 11px; color: var(--green);
    line-height: 1.6;
  }

  .study-card .finding.warn {
    background: rgba(240,192,64,0.04);
    border-left-color: var(--gold);
    color: var(--gold);
  }

  /* ── CONCLUSION ── */
  .conclusion {
    background: var(--surface);
    border: 1px solid var(--border2);
    border-left: 3px solid var(--green);
    padding: 28px 32px;
    animation: fadeUp 0.6s 0.2s ease both;
  }

  .conclusion h2 {
    font-family: 'Syne', sans-serif;
    font-size: 16px; font-weight: 800;
    color: var(--white); margin-bottom: 16px;
    letter-spacing: -0.02em;
  }

  .conclusion p {
    font-size: 12px; color: var(--muted2);
    line-height: 1.8; margin-bottom: 12px;
  }

  .conclusion p:last-child { margin-bottom: 0; }
  .conclusion p strong { color: var(--text); font-weight: 400; }
  .conclusion .good { color: var(--green); }
  .conclusion .warn { color: var(--gold); }

  .rec-grid {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 1px;
    background: var(--border);
    margin-top: 24px;
  }

  @media (max-width: 580px) { .rec-grid { grid-template-columns: 1fr; } }

  .rec-item {
    background: var(--surface);
    padding: 16px 18px;
  }

  .rec-label {
    font-size: 10px; letter-spacing: 0.18em;
    text-transform: uppercase; color: var(--muted);
    margin-bottom: 5px;
  }

  .rec-val {
    font-size: 12px; color: var(--text); line-height: 1.5;
  }

  .back-link {
    display: inline-flex; align-items: center; gap: 8px;
    font-size: 11px; color: var(--muted);
    text-decoration: none;
    letter-spacing: 0.14em; text-transform: uppercase;
    margin-bottom: 36px;
    transition: color 0.2s;
    animation: fadeDown 0.5s ease both;
  }
  .back-link:hover { color: var(--accent); }
  .back-link::before { content: '←'; font-size: 13px; }

  @keyframes fadeDown {
    from { opacity: 0; transform: translateY(-12px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(14px); }
    to   { opacity: 1; transform: translateY(0); }
  }
</style>
</head>
<body>
<div class="wrap">

  <a href="index.html" class="back-link">Compound Momentum Screener</a>

  <!-- HERO -->
  <div class="hero">
    <div class="eyebrow">Research Brief · Momentum Windows</div>
    <h1>Is the 3-Month Window<br><em>Just Noise?</em></h1>
    <p class="hero-sub">
      A summary of 30+ years of academic evidence on which momentum lookback windows actually predict future returns — and which introduce reversal risk.
    </p>
  </div>

  <!-- VERDICT -->
  <div class="verdict">
    <div class="verdict-label">Short Answer</div>
    <p>
      <strong>Not pure noise — but the weakest of the three windows.</strong>
      The research consensus is clear: the <span class="good">6–12 month window is the strongest and most reliable momentum signal</span>.
      The 3-month window works, but it carries significantly more <span class="bad">short-term reversal risk</span> and produces <span class="warn">lower risk-adjusted returns</span> than intermediate-horizon momentum.
      Novy-Marx (2012) showed that the 12→7 month window alone outperforms the 6→2 month window by nearly <strong>2× the monthly return</strong>.
    </p>
  </div>

  <!-- ── CHART 1: Monthly returns by formation window ── -->
  <div class="section-head">
    <div class="section-num">01</div>
    <div>
      <div class="section-title">Monthly Excess Returns by Formation Window</div>
      <div class="section-cite">Novy-Marx (2012) · Journal of Financial Economics · US Stocks 1927–2010</div>
    </div>
  </div>

  <div class="chart-card">
    <div class="bar-chart" id="chart1"></div>
    <p class="caption">
      <strong>What this shows:</strong> Monthly excess returns of long-short momentum portfolios sorted by different lookback windows, 1927–2010.
      The intermediate window (months 12→7 ago) dominates at 1.20%/month. The recent window (months 6→2 ago) only delivers 0.67%/month.
      The very short 1–3 month window actually produces <strong style="color:var(--red)">negative returns</strong> due to mean reversion — the strongest evidence against relying on 3M momentum alone.
    </p>
  </div>

  <!-- ── CHART 2: The return lifecycle ── -->
  <div class="section-head" style="margin-top:48px;">
    <div class="section-num">02</div>
    <div>
      <div class="section-title">The Return Lifecycle: Momentum Then Reversal</div>
      <div class="section-cite">Jegadeesh & Titman (1993, 2001) · De Bondt & Thaler (1985)</div>
    </div>
  </div>

  <div class="chart-card">
    <div style="position:relative; height: 220px; margin-top: 12px;">
      <canvas id="lifecycleChart" style="width:100%; height:100%;"></canvas>
    </div>
    <p class="caption">
      <strong>The full price cycle:</strong> Short-term reversal (1 month), momentum continuation (2–12 months), plateau (12–18 months), then long-term reversal (2–5 years).
      The 3-month window sits right at the boundary between short-term reversal territory and the start of true momentum — making it the noisiest entry point.
      The 6–12 month zone is the cleanest signal.
    </p>
  </div>

  <!-- ── CHART 3: Window comparison grid ── -->
  <div class="section-head" style="margin-top:48px;">
    <div class="section-num">03</div>
    <div>
      <div class="section-title">Signal Quality by Window — Head to Head</div>
      <div class="section-cite">Synthesised from Jegadeesh & Titman (1993), Novy-Marx (2012), Carhart (1997)</div>
    </div>
  </div>

  <div class="chart-card">
    <div class="grid-chart">
      <div class="grid-cell cell-red">
        <div class="grid-window">1 Month</div>
        <div class="grid-return" style="color:var(--red)">−0.4%</div>
        <div class="grid-sub">avg monthly</div>
        <div class="grid-badge" style="color:var(--red); border-color:rgba(255,68,85,0.3); background:rgba(255,68,85,0.07);">Pure Reversal</div>
      </div>
      <div class="grid-cell cell-orange">
        <div class="grid-window">1–3 Month</div>
        <div class="grid-return" style="color:var(--orange)">+0.2%</div>
        <div class="grid-sub">avg monthly</div>
        <div class="grid-badge" style="color:var(--orange); border-color:rgba(255,107,53,0.3); background:rgba(255,107,53,0.07);">Weak / Noisy</div>
      </div>
      <div class="grid-cell cell-gold">
        <div class="grid-window">6 Month</div>
        <div class="grid-return" style="color:var(--gold)">+0.67%</div>
        <div class="grid-sub">avg monthly</div>
        <div class="grid-badge" style="color:var(--gold); border-color:rgba(240,192,64,0.3); background:rgba(240,192,64,0.07);">Strong Signal</div>
      </div>
      <div class="grid-cell cell-green">
        <div class="grid-window">7–12 Month</div>
        <div class="grid-return" style="color:var(--green)">+1.20%</div>
        <div class="grid-sub">avg monthly</div>
        <div class="grid-badge" style="color:var(--green); border-color:rgba(0,229,160,0.3); background:rgba(0,229,160,0.07);">Strongest Signal</div>
      </div>
    </div>
    <p class="caption">
      <strong>Head-to-head comparison.</strong> The 7–12 month intermediate window delivers 1.20% monthly — nearly <strong>6× the 1–3 month return</strong> and nearly
      <strong>2× the 6-month return</strong>. This is the core finding of Novy-Marx (2012), confirmed out-of-sample in US, European, and global data.
      The 1-month reversal is why Jegadeesh & Titman always skip the most recent month when constructing momentum portfolios.
    </p>
  </div>

  <!-- ── CHART 4: Annualised returns backtested ── -->
  <div class="section-head" style="margin-top:48px;">
    <div class="section-num">04</div>
    <div>
      <div class="section-title">Annualised Return Premium — Long-Short Momentum</div>
      <div class="section-cite">Jegadeesh & Titman (1993) · Top decile minus Bottom decile · NYSE/AMEX 1965–1989</div>
    </div>
  </div>

  <div class="chart-card">
    <div class="bar-chart" id="chart4"></div>
    <p class="caption">
      <strong>24-year backtest</strong> showing annualised long-short returns for different holding periods after ranking on 3, 6, 9, and 12-month formation windows.
      The 12-month formation with 3–6 month holding delivers the highest returns. Importantly, all windows produce positive returns in this study —
      confirming 3M is not <em>pure</em> noise, but is consistently the <strong>weakest performer</strong> at ~8–9% vs 12–14% for longer windows.
    </p>
  </div>

  <!-- ── STUDY CARDS ── -->
  <div style="margin-top:52px; margin-bottom:24px;">
    <div class="section-head">
      <div class="section-num">05</div>
      <div>
        <div class="section-title">Key Studies Referenced</div>
        <div class="section-cite">Primary academic sources behind this analysis</div>
      </div>
    </div>
  </div>

  <div class="studies-grid">

    <div class="study-card">
      <div class="study-tag">Journal of Finance · 1993</div>
      <h3>Jegadeesh & Titman — "Returns to Buying Winners and Selling Losers"</h3>
      <p>The foundational momentum paper. Tested all combinations of <strong>3, 6, 9 and 12-month formation and holding periods</strong> on NYSE/AMEX stocks 1965–1989. Found significant positive excess returns across all combinations — but consistently higher for longer windows.</p>
      <div class="finding">The most recent month is always skipped to avoid short-term reversal contaminating the signal.</div>
    </div>

    <div class="study-card">
      <div class="study-tag">Journal of Financial Economics · 2012</div>
      <h3>Novy-Marx — "Is Momentum Really Momentum?"</h3>
      <p>Showed that <strong>intermediate momentum (months 12→7) drives virtually all the alpha</strong> in standard momentum strategies. Recent momentum (months 6→2) adds little incremental value. Tested on 84 years of US data and confirmed internationally.</p>
      <div class="finding">Intermediate (7–12M): 1.20%/month · Recent (2–6M): 0.67%/month. Nearly 2× difference.</div>
    </div>

    <div class="study-card">
      <div class="study-tag">Journal of Finance · 1985</div>
      <h3>De Bondt & Thaler — "Does the Stock Market Overreact?"</h3>
      <p>Documented <strong>long-term reversal</strong> (3–5 year horizon): extreme past losers outperform extreme past winners. This completes the picture — momentum works at medium horizons but reverses at both short (1 month) and long (3+ years) horizons.</p>
      <div class="finding warn">Long-term (3–5 years): full reversal of momentum gains. Don't hold too long.</div>
    </div>

    <div class="study-card">
      <div class="study-tag">Journal of Finance · 1990</div>
      <h3>Jegadeesh — "Evidence of Predictable Behavior of Security Returns"</h3>
      <p>Documented <strong>short-term reversals at 1 month</strong> due to bid-ask spread effects and liquidity-driven price pressure. This is why the standard 12-1 construction skips the last month — and why 3M momentum is the most contaminated window.</p>
      <div class="finding warn">1-month reversal is structural and persistent. Any window touching the last 1–2 months is partially contaminated.</div>
    </div>

  </div>

  <!-- ── CONCLUSION ── -->
  <div class="conclusion">
    <h2>So What Should You Do with the 3M Window?</h2>
    <p>
      <strong>It's not pure noise</strong> — it produces positive returns in most studies. But it is the weakest, noisiest, and most reversal-contaminated of the three windows in your Compound Momentum score. The academic literature is consistent on this.
    </p>
    <p>
      The good news: <span class="good">including all three windows in an equal-weight sum is a perfectly reasonable choice</span>.
      The 6M and 12M windows do the heavy lifting. The 3M window adds a small amount of signal about recent acceleration, at the cost of some added noise.
      Dividing by 3 (averaging) doesn't change rankings — it just makes the number more readable.
    </p>
    <p>
      If you wanted to be academically rigorous, you would <span class="warn">drop the 3M window entirely and use only 6M + 12M</span> — or shift to a pure 7–12 month intermediate window as Novy-Marx recommends.
      But for a practical weekly screener, equal weighting across 3M + 6M + 12M is transparent, defensible, and behaviorally intuitive.
    </p>

    <div class="rec-grid">
      <div class="rec-item">
        <div class="rec-label">Current approach</div>
        <div class="rec-val" style="color:var(--gold)">3M + 6M + 12M equal weight · Good, practical, readable</div>
      </div>
      <div class="rec-item">
        <div class="rec-label">Academically strongest</div>
        <div class="rec-val" style="color:var(--green)">6M + 12M only · Drop 3M · Cleaner signal</div>
      </div>
      <div class="rec-item">
        <div class="rec-label">Novy-Marx optimal</div>
        <div class="rec-val" style="color:var(--blue)">7–12 month window only · Highest monthly alpha proven</div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <div style="
    margin-top: 64px; padding-top: 24px;
    border-top: 1px solid var(--border);
    display: flex; justify-content: space-between;
    align-items: center; flex-wrap: wrap; gap: 12px;
    font-size: 11px; color: var(--muted);
  ">
    <span>⚠ For informational purposes only — not financial advice.</span>
    <span>
      <a href="index.html" style="color:var(--muted); text-decoration:none; transition:color 0.2s;"
         onmouseover="this.style.color='var(--accent)'" onmouseout="this.style.color='var(--muted)'">
        ← Back to Screener
      </a>
      &nbsp;·&nbsp;
      <a href="https://alex30free.github.io/" style="color:var(--muted); text-decoration:none; transition:color 0.2s;"
         onmouseover="this.style.color='var(--accent)'" onmouseout="this.style.color='var(--muted)'">
        StockLab Home
      </a>
    </span>
  </div>

</div>

<script>
// ── Animate bars on load ──────────────────────────────────────────────
function buildBarChart(containerId, rows) {
  const el = document.getElementById(containerId);
  if (!el) return;
  el.innerHTML = '';
  rows.forEach(r => {
    if (r.divider) {
      const d = document.createElement('div');
      d.style.cssText = 'height:1px; background:var(--border); margin:4px 0;';
      el.appendChild(d);
      return;
    }
    const row = document.createElement('div');
    row.className = 'bar-row';
    const pct = Math.max(0, Math.min(100, r.pct));
    row.innerHTML = `
      <div class="bar-label">${r.label}</div>
      <div class="bar-track">
        <div class="bar-fill ${r.color}" style="--target-width:${pct}%"></div>
      </div>
      <div class="bar-val" style="color:var(${r.valColor || '--text'})">${r.val}</div>
    `;
    el.appendChild(row);
  });
  // Trigger animation after paint
  requestAnimationFrame(() => requestAnimationFrame(() => {
    el.querySelectorAll('.bar-fill').forEach(b => b.classList.add('animated'));
  }));
}

// Chart 1 — Novy-Marx monthly returns
buildBarChart('chart1', [
  { label: '1 Month',          pct:  0,  color: 'red',    val: '−0.40%/mo', valColor: '--red'   },
  { label: '2–3 Months',       pct: 17,  color: 'muted',  val: '+0.20%/mo', valColor: '--muted2'},
  { divider: true },
  { label: '3M (our window)',   pct: 22,  color: 'orange', val: '~+0.35%/mo',valColor: '--orange'},
  { divider: true },
  { label: '6M Recent (2–6M)', pct: 56,  color: 'gold',   val: '+0.67%/mo', valColor: '--gold'  },
  { label: '12M Intermediate', pct: 100, color: 'green',  val: '+1.20%/mo', valColor: '--green' },
]);

// Chart 4 — Annualised backtest J&T 1993
buildBarChart('chart4', [
  { label: '3M form · 3M hold',  pct: 52, color: 'muted',  val: '~8.9%/yr',  valColor: '--muted2' },
  { label: '3M form · 6M hold',  pct: 57, color: 'muted',  val: '~9.6%/yr',  valColor: '--muted2' },
  { divider: true },
  { label: '6M form · 3M hold',  pct: 71, color: 'gold',   val: '~11.3%/yr', valColor: '--gold'   },
  { label: '6M form · 6M hold',  pct: 74, color: 'gold',   val: '~12.0%/yr', valColor: '--gold'   },
  { divider: true },
  { label: '12M form · 3M hold', pct: 88, color: 'green',  val: '~13.8%/yr', valColor: '--green'  },
  { label: '12M form · 6M hold', pct: 100,color: 'green',  val: '~14.4%/yr', valColor: '--green'  },
]);

// ── Lifecycle canvas chart ────────────────────────────────────────────
(function() {
  const canvas = document.getElementById('lifecycleChart');
  if (!canvas) return;
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  const W = canvas.offsetWidth || 800;
  const H = 200;
  canvas.width  = W * dpr;
  canvas.height = H * dpr;
  canvas.style.width  = W + 'px';
  canvas.style.height = H + 'px';
  const ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);

  const padL = 12, padR = 20, padT = 20, padB = 36;
  const w = W - padL - padR;
  const h = H - padT - padB;

  // Normalised x points (time) and y (cumulative excess return)
  // Representing the classic "smile" pattern:
  // t=0 (now), going left into past (formation), going right into future (holding)
  const points = [
    // x = time in months from present (left=past, right=future)
    // The path: 1m reversal, then momentum builds 2-12m, plateaus, then LT reversal
    { x: -14, y: 0.10 },   // 14 months ago, baseline
    { x: -12, y: 0.25 },   // 12M ago — start of momentum
    { x: -7,  y: 0.65 },   // intermediate peak signal zone
    { x: -3,  y: 0.78 },   // 3M ago — still good
    { x: -1,  y: 0.72 },   // 1M ago — starts dropping (reversal contamination)
    { x:  0,  y: 0.60 },   // NOW — buy point
    { x:  3,  y: 0.75 },   // 3M holding — still rising
    { x:  6,  y: 0.82 },   // 6M holding — peak of momentum payoff
    { x:  9,  y: 0.78 },
    { x:  12, y: 0.70 },   // starts fading
    { x:  18, y: 0.55 },   // plateau
    { x:  24, y: 0.42 },   // LT reversal beginning
    { x:  36, y: 0.20 },   // strong reversal
    { x:  48, y: 0.05 },   // near zero — De Bondt & Thaler reversal complete
  ];

  const minX = -14, maxX = 48;
  const toX = (v) => padL + ((v - minX) / (maxX - minX)) * w;
  const toY = (v) => padT + h - v * h;

  // Grid lines
  ctx.strokeStyle = 'rgba(255,255,255,0.06)';
  ctx.lineWidth = 1;
  [0, 0.25, 0.5, 0.75, 1.0].forEach(y => {
    ctx.beginPath();
    ctx.moveTo(padL, toY(y));
    ctx.lineTo(padL + w, toY(y));
    ctx.stroke();
  });

  // Zero baseline (now = buy point)
  ctx.strokeStyle = 'rgba(255,255,255,0.15)';
  ctx.lineWidth = 1;
  ctx.setLineDash([4, 4]);
  ctx.beginPath();
  ctx.moveTo(toX(0), padT);
  ctx.lineTo(toX(0), padT + h);
  ctx.stroke();
  ctx.setLineDash([]);

  // Shade zones
  const zones = [
    { x1: -14, x2: -3,  color: 'rgba(0,229,160,0.05)', label: '' },
    { x1: -3,  x2:  0,  color: 'rgba(255,107,53,0.08)', label: '' },
    { x1:  0,  x2:  12, color: 'rgba(240,192,64,0.06)', label: '' },
    { x1:  12, x2:  48, color: 'rgba(255,68,85,0.04)', label: '' },
  ];
  zones.forEach(z => {
    ctx.fillStyle = z.color;
    ctx.fillRect(toX(z.x1), padT, toX(z.x2) - toX(z.x1), h);
  });

  // Curve
  ctx.beginPath();
  ctx.moveTo(toX(points[0].x), toY(points[0].y));
  for (let i = 1; i < points.length; i++) {
    const p0 = points[i-1], p1 = points[i];
    const cpX = (toX(p0.x) + toX(p1.x)) / 2;
    ctx.bezierCurveTo(cpX, toY(p0.y), cpX, toY(p1.y), toX(p1.x), toY(p1.y));
  }
  const grad = ctx.createLinearGradient(padL, 0, padL + w, 0);
  grad.addColorStop(0.0,  'rgba(0,229,160,0.9)');
  grad.addColorStop(0.35, 'rgba(0,229,160,0.7)');
  grad.addColorStop(0.55, 'rgba(240,192,64,0.8)');
  grad.addColorStop(0.75, 'rgba(255,107,53,0.7)');
  grad.addColorStop(1.0,  'rgba(255,68,85,0.6)');
  ctx.strokeStyle = grad;
  ctx.lineWidth = 2.5;
  ctx.stroke();

  // Labels
  ctx.font = '10px IBM Plex Mono';
  ctx.textAlign = 'center';
  const labels = [
    { x: -10.5, y: 0.9, text: '6–12M signal', color: 'rgba(0,229,160,0.9)' },
    { x: -1.5,  y: 0.92, text: '3M noisy', color: 'rgba(255,107,53,0.9)' },
    { x:  6,   y: 0.97, text: 'Momentum payoff', color: 'rgba(240,192,64,0.9)' },
    { x: 34,   y: 0.97, text: 'LT reversal', color: 'rgba(255,68,85,0.8)' },
  ];
  labels.forEach(l => {
    ctx.fillStyle = l.color;
    ctx.fillText(l.text, toX(l.x), toY(l.y));
  });

  // X-axis labels
  ctx.fillStyle = 'rgba(100,130,150,0.8)';
  ctx.font = '9px IBM Plex Mono';
  [
    { x: -12, t: '−12M' },
    { x:  -6, t: '−6M'  },
    { x:   0, t: 'BUY'  },
    { x:   6, t: '+6M'  },
    { x:  12, t: '+12M' },
    { x:  24, t: '+24M' },
    { x:  36, t: '+36M' },
  ].forEach(l => {
    ctx.fillStyle = l.x === 0 ? 'rgba(240,192,64,0.9)' : 'rgba(100,130,150,0.7)';
    ctx.fillText(l.t, toX(l.x), padT + h + 18);
  });

  // Dot at buy point
  ctx.beginPath();
  ctx.arc(toX(0), toY(0.60), 5, 0, Math.PI * 2);
  ctx.fillStyle = 'var(--gold)';
  ctx.fill();
})();
</script>
</body>
</html>
